name: status check compile (does not push)
"on":
  push:
    branches-ignore: [master, main, fix-compile.yaml]
  pull_request:
    types: [opened, edited]
  workflow_call:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout git repository
        uses: actions/checkout@v3
      # https://github.com/actions/cache/issues/342
      - name: üíæ Caching
        uses: actions/cache@v3
        with:
          path: |
            build
            sub_*
          key: ${{ runner.os }}-pengu-cache-doc-${{ github.run_id }}
          restore-keys: ${{ runner.os }}-pengu-cache-doc-
      - name: üìÑ Compile the Documentation
        uses: xu-cheng/latex-action@v2
        with:
          working_directory: doc
          root_file: tikzpingus-doc.tex
      - name: üìÑ Compile Examples
        uses: xu-cheng/latex-action@v2
        with:
          working_directory: examples
          root_file: |
            showcase.tex
            minimal.tex
      - name: ‚¨ÜÔ∏è Upload doc artifacts
        uses: actions/upload-artifact@v3
        with:
          name: doc-output
          path: |
            doc/build/*.pdf
            doc/build/tikzpingus-doc.*
      - name: ‚¨ÜÔ∏è Upload examples artifacts
        uses: actions/upload-artifact@v3
        with:
          name: examples-output
          path: examples/build/*.pdf
